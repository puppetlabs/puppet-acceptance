Running the Distributed Test Harness

Pre-flight checks:

  - You will need at least one System Undet Test (SUT) host, physical or virtual is fine.  The machine will need a properly configured network.
  - On the your SUT, you must configure pass through ssh auth for the root user.
  - The SUT have have the "ntpdate" binary installed
  - GIT installs: installing from a git repository then you must have git, ruby, rdoc installed on your SUT. 
  - PE installs: PE will install git, ruby, rdoc.

  - The harness need not be ran as root.
  - The machine that will drive the tests must have ruby installed, inclduing the following ruby gems:
     rubygems
     net-ssh 
     net-scp
     systemu


Prepare a config file:

The test harness is configuration driven; the config file is yaml formated.  A basic config file sufficent for running tests against a single host:

HOSTS:
  hostname_of_test_machine:
    roles:
      - master
      - agent
    platform: el-5-i386
CONFIG:
  nfs_server: NONE  

Here we have the machine "hostname_of_test_machine", a Centos 5.x 32 bit box,, that will serve as a Pupppet master and Agent.  No NFS server has been configured.

A comprehensive list of all supported plaforms and config settings can be found in:
cfg_examples/all-platforms.cfg


systest has a large number of useful options - please invoke with systest.rb -h for more details.



Steps to run the acceptance tests:

To test on FOSS
./systest.rb -c your_cfg --debug --type git -p 2.6.next  -f 1.5.8 -t path-to-your-tests 

To test on PE
./systest.rb -c your_cfg --debug --type pe -t path-to-your-tests 

Results will be written to log/latest/summary.txt and runlog

path-to-test:
If you are testing on FOSS, the test for each branch can be found in the puppet repo under acceptance/tests

If you are testing a PE build, the PE specific tests are under seperate repo: pe_accepance_test in acceptance/tests (git@github.com:puppetlabs/pe_acceptance_tests.git)


Special topic branch checkout:
./systest.rb -c 2centos_64_386 --type git -p https://github.com/SomeDude/puppet/tree/ticket/2.6.next/6856-dangling-symlinks -f 1.5.8 -t tests/acceptance/ticket_6856_manage_not_work_with_symlinks.rb
